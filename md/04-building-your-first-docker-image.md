# Урок 4. Создание первого образа Docker

## Введение в Dockerfile

**Dockerfile** — это текстовый файл, содержащий ряд инструкций по созданию образа Docker. Он определяет базовый образ, код приложения, зависимости и любые другие конфигурации, необходимые для создания образа.

### Ключевые компоненты Dockerfile:
- **FROM**. Указывает базовый образ для использования.
- **COPY**. Копирует файлы из локальной файловой системы в образ.
- **RUN**. Выполняет команды в образе во время процесса сборки.
- **CMD**. Указывает команду для запуска при запуске контейнера из образа.

## Шаг 1. Написание простого Dockerfile

Давайте создадим простой Dockerfile для создания образа, который запускает простое веб-приложение с использованием Python. Выполните следующие шаги:

### Создайте каталог проекта

1. Откройте терминал и создайте новый каталог для вашего проекта:

```bash
mkdir my-python-app
cd my-python-app
```

### Создайте простое приложение Python

2. Создайте файл с именем `app.py` в каталоге `my-python-app` со следующим содержимым:

```python
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
return "Hello, Docker!"

if __name__ == '__main__':
app.run(host='0.0.0.0')
```

### Создайте Dockerfile

3. В том же каталоге создайте файл с именем `Dockerfile` (без расширения) и добавьте следующее содержимое:

```dockerfile
# Используйте официальный образ Python из Docker Hub
FROM python:3.9-slim

# Установите рабочий каталог в контейнере
WORKDIR /app

# Скопируйте файл требований и установите зависимости
COPY requirements.txt requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Скопируйте код приложения в контейнер
COPY app.py app.py

# Откройте порт, на котором работает приложение
EXPOSE 5000

# Команда для запуска приложения
CMD ["python", "app.py"]
```

### Создайте файл требований

4. Создайте файл с именем `requirements.txt` в том же каталоге и добавьте следующую строку:

```
Flask
```

## Создайте свой образ Docker

Теперь, когда есть готовый Dockerfile и код приложения, можно создать свой образ Docker.

### Создание образа

1. В терминале перейдите в каталог `my-python-app`  и выполните следующую команду для создания образа:

```bash
docker build -t my-python-app .
```

- Флаг `-t` помечает образ именем (`my-python-app`).
- `.` в конце указывает контекст сборки (текущий каталог).

### Проверка образа

2. После завершения процесса сборки проверьте, что образ был создан, запустив:

```bash
docker images
```

Вы должны увидеть `my-python-app` в списке доступных образов.

## Запустите ваш образ Docker

Теперь, когда образ создан, можно запустить его как контейнер.

### Запустите контейнер

1. Используйте следующую команду для запуска вашего контейнера Docker:

```bash
docker run -p 5000:5000 my-python-app
```

- Флаг `-p` сопоставляет порт 5000 на вашем хост-компьютере с портом 5000 в контейнере.

### Доступ к приложению

2. Откройте веб-браузер и перейдите по адресу `http://localhost:5000`. Вы должны увидеть сообщение:

```
Hello, Docker!

```

## ШОстановка контейнера

Чтобы остановить работающий контейнер, вы можете нажать `Ctrl + C` в терминале, где запущен контейнер, или открыть новый терминал и выполнить:

```bash
docker ps
```

Найдите идентификатор или имя контейнера, затем остановите его с помощью:

```bash
docker stop <container-id>
```

## Заключение

В этом уроке вы узнали, как написать простой Dockerfile для создания пользовательского образа Docker и как создать и запустить этот образ локально. Теперь у вас есть базовые знания о том, как упаковывать приложения с помощью Docker. В следующем уроке мы рассмотрим основы работы в сети Docker и то, как контейнеры взаимодействуют друг с другом.

### Контрольные вопросы:
1. Что такое Dockerfile и для чего он используется?
2. Какие основные инструкции используются в Dockerfile?
3. Как выполняется сборка образа Docker с использованием Dockerfile?
4. Как запустить контейнер из собранного образа?
5. Каковы преимущества использования Dockerfile для создания образов Docker?
